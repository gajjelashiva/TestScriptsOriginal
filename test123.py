from bs4 import BeautifulSoup
import wget
import os

#URL_main = 'https://mats.webex.com/rest/ucre/sipcallflow/{}GMT{}%20Greenwich%20Mean%20Time--GMT?keyWord=432ad540e7cc4d012a34c07fe79be53d@10.252.67.196&startTime=2019-04-15%2014:35:51&endTime=2019-04-16%2014:35:51'.format('(',')')
#name_main_file = 'DIAL_OUT_MATS.html'
#main_command =                'wget --header \'Host: mats.webex.com\' ' \
                              # '--user-agent \'Mozilla\/5.0 \(Macintosh; Intel Mac OS X 10.14; rv:66.0\)' \
                              # ' Gecko/20100101 Firefox/66.0\' --header ' \
                              # '\'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\' ' \
                              # '--header \'Accept-Language: en-US,en;q=0.5\' ' \
                              # '--referer \'https://mats.webex.com/rest/ucre/sipcallflow/\(GMT\)%20Greenwich%20Mean%20Time--GMT?keyWord=432ad540e7cc4d012a34c07fe79be53d@10.252.67.196&startTime=2019-04-15%2014:35:51&endTime=2019-04-16%2014:35:51\' --output-document {} --header \'Cookie: optimizelyEndUserId=oeu1549269338349r0.7158015530100864; ajs_user_id=%22dbbe9e7c-6eb2-4098-a1d3-e76844df5b4a%22; ajs_group_id=null; ajs_anonymous_id=%22d88a0e99-b03d-4f47-8130-c8b1c58884f8%22; CK_PMRAttendee=RzH__wAAAIUhuueD7T0bMR8Y9j_ZGwKOVp6w0B2Lsxv9nt0ZMAipVQ2:1554717475912:login; CK_AttendeeInfo=rO0ABXNyAD5jb20ud2ViZXgud2ViYXBwLmNvbW1vbi51dGlsLk1lZXRpbmdBdHRlbmRlZUluZm9F%0AeHRlcm5hbGl6YWJsZdR43RCnDwq7DAAAeHBwcHBwcHBwcHBwcHBwcHB3CP%2F%2F%2F%2F8AAAABeA%3D%3D; AMCV_5C0A123F5245AEEA0A490D45%40AdobeOrg=-330454231%7CMCIDTS%7C17995%7CMCMID%7C90611361302488200140228232621388671088%7CMCAAMLH-1555322308%7C3%7CMCAAMB-1555322308%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1554724708s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.1.2; mbox=PC#e02ef317b7a74ce1828a6f57e3a4b367.22_9#1562493510|check#true#1554717570|session#f87173fcf88246c39364398ec7f2378a#1554719370; _ga=GA1.2.1159115488.1551776486; lp_host=yes; matsUserName4CI=sgajjela%40cisco.com; NSC_ttm-nbutwjqtk-443-wjq=ffffffff09f41a0f45525d5f4f58455e445a4a423660; amlbcookie=15; cisPRODiPlanetDirectoryPro=AQIC5wM2LY4SfcwAAnUyx1hu0uz0Os0quhmu9kdT_bhvAOc.*AAJTSQACMDIAAlNLABQtNjk4MTQ5NzAzOTk5NDc2MjU4NwACUzEAAjE1*; JSESSIONID=3400D6C8166BEF1790FB1B37ADF3B927\'' \
                              # ' --header \'Upgrade-Insecure-Requests: 1\' \'https://mats.webex.com/rest/ucre/sipcallflow/\(GMT\)%20Greenwich%20Mean%20Time--GMT?keyWord=432ad540e7cc4d012a34c07fe79be53d@10.252.67.196&startTime=2019-04-15%2014:35:51&endTime=2019-04-16%2014:35:51\'  --output-document {} --no-check-certificate'.format(name_main_file,  name_main_file)

#print(main_command)
#os.system(main_command)
#os.system('wget --header \'Host: mats.webex.com\' --user-agent \'Mozilla\/5.0 \(Macintosh; Intel Mac OS X 10.14; rv:66.0\) Gecko/20100101 Firefox/66.0\' --header \'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\' --header \'Accept-Language: en-US,en;q=0.5\' --referer {} --output-document {}  --header \'Cookie: optimizelyEndUserId=oeu1549269338349r0.7158015530100864; ajs_user_id=%22dbbe9e7c-6eb2-4098-a1d3-e76844df5b4a%22; ajs_group_id=null; ajs_anonymous_id=%22d88a0e99-b03d-4f47-8130-c8b1c58884f8%22; CK_PMRAttendee=RzH__wAAAIUhuueD7T0bMR8Y9j_ZGwKOVp6w0B2Lsxv9nt0ZMAipVQ2:1554717475912:login; CK_AttendeeInfo=rO0ABXNyAD5jb20ud2ViZXgud2ViYXBwLmNvbW1vbi51dGlsLk1lZXRpbmdBdHRlbmRlZUluZm9F%0AeHRlcm5hbGl6YWJsZdR43RCnDwq7DAAAeHBwcHBwcHBwcHBwcHBwcHB3CP%2F%2F%2F%2F8AAAABeA%3D%3D; AMCV_5C0A123F5245AEEA0A490D45%40AdobeOrg=-330454231%7CMCIDTS%7C17995%7CMCMID%7C90611361302488200140228232621388671088%7CMCAAMLH-1555322308%7C3%7CMCAAMB-1555322308%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1554724708s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.1.2; mbox=PC#e02ef317b7a74ce1828a6f57e3a4b367.22_9#1562493510|check#true#1554717570|session#f87173fcf88246c39364398ec7f2378a#1554719370; _ga=GA1.2.1159115488.1551776486; lp_host=yes; matsUserName4CI=sgajjela%40cisco.com; NSC_ttm-nbutwjqtk-443-wjq=ffffffff09f41a0f45525d5f4f58455e445a4a423660; amlbcookie=15; cisPRODiPlanetDirectoryPro=AQIC5wM2LY4SfcwAAnUyx1hu0uz0Os0quhmu9kdT_bhvAOc.*AAJTSQACMDIAAlNLABQtNjk4MTQ5NzAzOTk5NDc2MjU4NwACUzEAAjE1*; JSESSIONID=3400D6C8166BEF1790FB1B37ADF3B927\' --header \'Upgrade-Insecure-Requests: 1\' {} --output-document {} --no-check-certificate'.format(URL_main , name_main_file ,URL_main ,name_main_file))
with open('/Users/sgajjela/PycharmProjects/test/venv/DIALOUT_FINAL.html') as fp:
            soup = BeautifulSoup(fp, 'html.parser')
            results_row_tag = soup.find_all('a')
            for row in results_row_tag:
                text = str(row).split('href=')
                req_text = text[1].split('>')[0] if len(text) >1 else None
                print('the text is %s' %text)

                if 'siprspdetail.jsp' in req_text:
                    final_op = req_text.strip('"')
                    print('the results row is %s' % req_text.strip('"'))
                    report_page = '/Users/sgajjela/PycharmProjects/test/venv'+final_op
                   # website = 'https://mats.webex.com%s'%final_op
                    website = final_op
                    command="wget --header 'Host: matsbts.webex.com' --user-agent 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0' --header 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' --header 'Accept-Language: en-US,en;q=0.5' --referer {} --header 'Cookie: ajs_user_id=%22dbbe9e7c-6eb2-4098-a1d3-e76844df5b4a%22; ajs_group_id=null; ajs_anonymous_id=%22d88a0e99-b03d-4f47-8130-c8b1c58884f8%22; CK_PMRAttendee=RzH__wAAAIXr_1rN_5WTkPP762-zL98dVPCMHzADBQUtwIqhMc2WLg2:1569240632324:login; CK_AttendeeInfo=rO0ABXNyAD5jb20ud2ViZXgud2ViYXBwLmNvbW1vbi51dGlsLk1lZXRpbmdBdHRlbmRlZUluZm9F%0AeHRlcm5hbGl6YWJsZdR43RCnDwq7DAAAeHBwcHBwcHBwcHBwcHBwcHB3CP%2F%2F%2F%2F8AAAABeA%3D%3D; _pk_id.23.c686=17a77e277b8dee87.1551418170.1.1551418187.1551418170.; AMCV_5C0A123F5245AEEA0A490D45%40AdobeOrg=1585540135%7CMCIDTS%7C18150%7CMCMID%7C90611361302488200140228232621388671088%7CMCAAMLH-1568785133%7C12%7CMCAAMB-1568785133%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1568187533s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C4.4.0%7CMCSYNCSOP%7C411-18158; _ga=GA1.2.1159115488.1551776486; lp_host=yes; mbox=PC#04f78f1082a14ed5a975b2c79a3bc513.22_28#1631425133|session#f6f9786a3d5040d29a835161b14a87be#1568182193; utag_main=v_id:016d196c4b0e00ae34c72bafbe5000052002c00f0093c$_sn:2$_ss:0$_st:1568182137211$consent_prompt:true$ses_id:1568180333745%3Bexp-session$_pn:1%3Bexp-session$ctm_ss:true%3Bexp-session; CONSENTMGR=ts:1568089590818%7Cconsent:true; _gcl_au=1.1.1862570553.1568089591; optimizelyEndUserId=oeu1568175587888r0.04541814977226133; _hjid=d53d48de-9b54-4451-90ac-6afbf9a7bff2; stc120006=tsa:1666863276:20190911060856|env:1%7C20191012053856%7C20190911060856%7C1%7C1095238:20200910053856|uid:1568180336864.717571525.094012.120006.2017703631.4:20200910053856|srchist:1095238%3A1%3A20191012053856:20200910053856; _fbp=fb.1.1568180338002.360560792; CK_CDNHostStatus=testcdn.webex.com|1569231670482|0; ticket=AAABbV4ICSUAABUYA0gAKEgyU0sAAACFgK19gEpjHMs8Ut4mblAzEyLdx3NyoBPjgT6KBWfV9ZlBSABmAQFIMlNLAAAAhdzcEh7wdlNx8YYBhyXoHsixenIH0xaEdhVgHJE6RrQBU0sAAACFWg8r04+I5zGj0vG/RguVw6/kPYk0wyWGntaUOUFKezylwIC6ZEad+rqWgac43iEnKXuSm7vI/HjbB83qHGx7BVOztPk5q50OKUzvnEYxxASbVPr5Jt8TAUKwpDFY7rmit2KAUkmBYm/vOqksPu0yhvWL5r+dNFvC151LbuAg5ZOegBV1VXyou22czLeO5rWckbIBdpPqF2DDoTxOxuLdQqS+KgnvwKGg6WLExYzeF2UYt4KAUZA0dkUqKAnvVq63X0ZMQUdfQURESU5HX1NIQTI1Nl9BTEdPUklUSE1f; NSC_ttm-nbutcut-443-wjq=ffffffff09f4266045525d5f4f58455e445a4a423660; JSESSIONID=5D93779DC8C11D8307B47926AA01D181; matsUserName4CI=sgajjela%40cisco.com' --header 'Upgrade-Insecure-Requests: 1' 'https://matsbts.webex.com/{}' --output-document {} --no-check-certificate".format(report_page, website,report_page+'.html')
                    os.system(command)